<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Fast Randomized Iteration for Electronic Structure: /home/travis/build/sgreene8/FRIES/FRIES/Hamiltonians/molecule.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Fast Randomized Iteration for Electronic Structure
   </div>
   <div id="projectbrief">An implementation of FRI methods for quantum chemistry</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_607347b14e208e050cf2976c6f5bb11f.html">FRIES</a></li><li class="navelem"><a class="el" href="dir_881573b67d992baba3d2ba4317bef69e.html">Hamiltonians</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">molecule.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Utilities for a Hamiltonian describing a molecular system.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="molecule_8hpp_source.html">molecule.hpp</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af024927565dbbf58e9d0531f16709ee0"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="molecule_8cpp.html#af024927565dbbf58e9d0531f16709ee0">doub_matr_el_nosgn</a> (uint8_t *chosen_orbs, unsigned int n_orbs, const <a class="el" href="class_four_d_arr.html">FourDArr</a> &amp;eris, unsigned int n_frozen)</td></tr>
<tr class="memdesc:af024927565dbbf58e9d0531f16709ee0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate a double excitation matrix element.  <a href="#af024927565dbbf58e9d0531f16709ee0">More...</a><br /></td></tr>
<tr class="separator:af024927565dbbf58e9d0531f16709ee0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9473f4c958abc9b37546377efc75150"><td class="memItemLeft" align="right" valign="top"><a id="ae9473f4c958abc9b37546377efc75150"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>doub_matr_el_nosgn</b> (uint8_t *chosen_orbs, unsigned int n_orbs, const <a class="el" href="class_symm_e_r_is.html">SymmERIs</a> &amp;eris, unsigned int n_frozen)</td></tr>
<tr class="separator:ae9473f4c958abc9b37546377efc75150"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20cdcf19c43532b4aeac5cef2f9c9a38"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="molecule_8cpp.html#a20cdcf19c43532b4aeac5cef2f9c9a38">sing_matr_el_nosgn</a> (uint8_t *chosen_orbs, uint8_t *occ_orbs, unsigned int n_orbs, const <a class="el" href="class_four_d_arr.html">FourDArr</a> &amp;eris, const <a class="el" href="class_matrix.html">Matrix</a>&lt; double &gt; &amp;h_core, unsigned int n_frozen, unsigned int n_elec)</td></tr>
<tr class="memdesc:a20cdcf19c43532b4aeac5cef2f9c9a38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate a single excitation matrix element.  <a href="#a20cdcf19c43532b4aeac5cef2f9c9a38">More...</a><br /></td></tr>
<tr class="separator:a20cdcf19c43532b4aeac5cef2f9c9a38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2cc43da03891fcd64d38d3a5a6003d3"><td class="memItemLeft" align="right" valign="top"><a id="ad2cc43da03891fcd64d38d3a5a6003d3"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>sing_matr_el_nosgn</b> (uint8_t *chosen_orbs, uint8_t *occ_orbs, unsigned int n_orbs, const <a class="el" href="class_symm_e_r_is.html">SymmERIs</a> &amp;eris, const <a class="el" href="class_matrix.html">Matrix</a>&lt; double &gt; &amp;h_core, unsigned int n_frozen, unsigned int n_elec)</td></tr>
<tr class="separator:ad2cc43da03891fcd64d38d3a5a6003d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac98cb5204a85ad27106ece4c76a3ed7d"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="molecule_8cpp.html#ac98cb5204a85ad27106ece4c76a3ed7d">doub_ex_symm</a> (uint8_t *det, uint8_t *occ_orbs, unsigned int num_elec, unsigned int num_orb, uint8_t res_arr[][4], uint8_t *symm)</td></tr>
<tr class="memdesc:ac98cb5204a85ad27106ece4c76a3ed7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate all spin- and symmetry-allowed double excitations from a Slater determinant.  <a href="#ac98cb5204a85ad27106ece4c76a3ed7d">More...</a><br /></td></tr>
<tr class="separator:ac98cb5204a85ad27106ece4c76a3ed7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcd8b7de96bcaf419abbaf9ec393c7c4"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="molecule_8cpp.html#abcd8b7de96bcaf419abbaf9ec393c7c4">sing_ex_symm</a> (uint8_t *det, uint8_t *occ_orbs, unsigned int num_elec, unsigned int num_orb, uint8_t res_arr[][2], uint8_t *symm)</td></tr>
<tr class="memdesc:abcd8b7de96bcaf419abbaf9ec393c7c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate all spin- and symmetry-allowed single excitations from a Slater determinant.  <a href="#abcd8b7de96bcaf419abbaf9ec393c7c4">More...</a><br /></td></tr>
<tr class="separator:abcd8b7de96bcaf419abbaf9ec393c7c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6a0e9701b587b34adfc0fca9130554c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="molecule_8cpp.html#aa6a0e9701b587b34adfc0fca9130554c">h_op_diag</a> (<a class="el" href="class_dist_vec.html">DistVec</a>&lt; double &gt; &amp;vec, uint8_t dest_idx, double id_fac, double h_fac)</td></tr>
<tr class="memdesc:aa6a0e9701b587b34adfc0fca9130554c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deterministically multiply a vector by the diagonal portion of (a * I + b * H), where H is the Hamiltonian and I is the identity This method multiplies a sub-vector within the inputted <a class="el" href="class_dist_vec.html" title="Class for storing and manipulating a sparse vector. ">DistVec</a> object, as determined by its <code>curr_vec_idx</code> instance variable.  <a href="#aa6a0e9701b587b34adfc0fca9130554c">More...</a><br /></td></tr>
<tr class="separator:aa6a0e9701b587b34adfc0fca9130554c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ca322bdd6b3d5589e7523e8a182df0a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="molecule_8cpp.html#a1ca322bdd6b3d5589e7523e8a182df0a">one_elec_op</a> (<a class="el" href="class_dist_vec.html">DistVec</a>&lt; double &gt; &amp;vec, unsigned int n_orbs, uint8_t des_op, uint8_t cre_op, uint8_t dest_idx)</td></tr>
<tr class="memdesc:a1ca322bdd6b3d5589e7523e8a182df0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deterministically multiply a vector by a 1-electron operator a^ a_q.  <a href="#a1ca322bdd6b3d5589e7523e8a182df0a">More...</a><br /></td></tr>
<tr class="separator:a1ca322bdd6b3d5589e7523e8a182df0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a2d6a8da12e88bebd2886986ac923e3"><td class="memItemLeft" align="right" valign="top"><a id="a5a2d6a8da12e88bebd2886986ac923e3"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>h_op_offdiag</b> (<a class="el" href="class_dist_vec.html">DistVec</a>&lt; double &gt; &amp;vec, uint8_t *symm, unsigned int n_orbs, const <a class="el" href="class_four_d_arr.html">FourDArr</a> &amp;eris, const <a class="el" href="class_matrix.html">Matrix</a>&lt; double &gt; &amp;h_core, uint8_t *orbs_scratch, unsigned int n_frozen, unsigned int n_elec, uint8_t dest_idx, double h_fac)</td></tr>
<tr class="separator:a5a2d6a8da12e88bebd2886986ac923e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2b798495504b559a7354c3c0ad287de"><td class="memItemLeft" align="right" valign="top"><a id="ab2b798495504b559a7354c3c0ad287de"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>h_op_offdiag</b> (<a class="el" href="class_dist_vec.html">DistVec</a>&lt; double &gt; &amp;vec, uint8_t *symm, unsigned int n_orbs, const <a class="el" href="class_four_d_arr.html">FourDArr</a> &amp;eris, const <a class="el" href="class_matrix.html">Matrix</a>&lt; double &gt; &amp;h_core, uint8_t *orbs_scratch, unsigned int n_frozen, unsigned int n_elec, uint8_t dest_idx, double h_fac, int spin_parity)</td></tr>
<tr class="separator:ab2b798495504b559a7354c3c0ad287de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04c1719bb4bb7b5fc1ff9a08d1b61e69"><td class="memItemLeft" align="right" valign="top"><a id="a04c1719bb4bb7b5fc1ff9a08d1b61e69"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>h_op_offdiag</b> (<a class="el" href="class_dist_vec.html">DistVec</a>&lt; double &gt; &amp;vec, uint8_t *symm, unsigned int n_orbs, const <a class="el" href="class_symm_e_r_is.html">SymmERIs</a> &amp;eris, const <a class="el" href="class_matrix.html">Matrix</a>&lt; double &gt; &amp;h_core, uint8_t *orbs_scratch, size_t scratch_size, unsigned int n_frozen, unsigned int n_elec, uint8_t dest_idx, double h_fac, int spin_parity)</td></tr>
<tr class="separator:a04c1719bb4bb7b5fc1ff9a08d1b61e69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c69a34ba225f016e4e138c7cbed3fe7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="molecule_8cpp.html#a1c69a34ba225f016e4e138c7cbed3fe7">h_op_offdiag</a> (<a class="el" href="class_dist_vec.html">DistVec</a>&lt; double &gt; &amp;vec, size_t vec_size, uint8_t *symm, unsigned int n_orbs, const <a class="el" href="class_symm_e_r_is.html">SymmERIs</a> &amp;eris, const <a class="el" href="class_matrix.html">Matrix</a>&lt; double &gt; &amp;h_core, uint8_t *orbs_scratch, size_t scratch_size, unsigned int n_frozen, unsigned int n_elec, uint8_t dest_idx, double h_fac, int spin_parity)</td></tr>
<tr class="memdesc:a1c69a34ba225f016e4e138c7cbed3fe7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deterministically multiply a vector by the off-diagonal elements of the Hamiltonian matrix times a constant factor This method multiplies a sub-vector within the inputted <a class="el" href="class_dist_vec.html" title="Class for storing and manipulating a sparse vector. ">DistVec</a> object, as determined by its <code>curr_vec_idx</code> instance variable.  <a href="#a1c69a34ba225f016e4e138c7cbed3fe7">More...</a><br /></td></tr>
<tr class="separator:a1c69a34ba225f016e4e138c7cbed3fe7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3c7257f4bfe5597197e4280095bfdf8"><td class="memItemLeft" align="right" valign="top"><a id="ab3c7257f4bfe5597197e4280095bfdf8"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>calc_h_dot</b> (<a class="el" href="class_dist_vec.html">DistVec</a>&lt; double &gt; &amp;vec, uint8_t *symm, unsigned int n_orbs, const <a class="el" href="class_symm_e_r_is.html">SymmERIs</a> &amp;eris, const <a class="el" href="class_matrix.html">Matrix</a>&lt; double &gt; &amp;h_core, uint8_t *orbs_scratch, size_t scratch_size, unsigned int n_frozen, unsigned int n_elec, int spin_parity, <a class="el" href="class_matrix.html">Matrix</a>&lt; double &gt; &amp;dot_vals, <a class="el" href="class_matrix.html">Matrix</a>&lt; double &gt; &amp;results)</td></tr>
<tr class="separator:ab3c7257f4bfe5597197e4280095bfdf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f35451f0df2c2f5c32af37aef293c32"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="molecule_8cpp.html#a9f35451f0df2c2f5c32af37aef293c32">count_doub_nosymm</a> (unsigned int num_elec, unsigned int num_orb)</td></tr>
<tr class="memdesc:a9f35451f0df2c2f5c32af37aef293c32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate number of double excitations from any determinant accounting only for spin symmetry.  <a href="#a9f35451f0df2c2f5c32af37aef293c32">More...</a><br /></td></tr>
<tr class="separator:a9f35451f0df2c2f5c32af37aef293c32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71b5f31424693d76a470f94a367b4973"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="molecule_8cpp.html#a71b5f31424693d76a470f94a367b4973">gen_hf_ex</a> (uint8_t *hf_det, uint8_t *hf_occ, unsigned int num_elec, unsigned int n_orb, uint8_t *orb_symm, const <a class="el" href="class_four_d_arr.html">FourDArr</a> &amp;eris, unsigned int n_frozen, <a class="el" href="class_matrix.html">Matrix</a>&lt; uint8_t &gt; &amp;ex_dets, double *ex_mel)</td></tr>
<tr class="memdesc:a71b5f31424693d76a470f94a367b4973"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the HF column of the FCI Hamiltonian.  <a href="#a71b5f31424693d76a470f94a367b4973">More...</a><br /></td></tr>
<tr class="separator:a71b5f31424693d76a470f94a367b4973"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35a859f8103553086e4d95202950242f"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="molecule_8cpp.html#a35a859f8103553086e4d95202950242f">count_singex</a> (uint8_t *det, const uint8_t *occ_orbs, uint32_t num_elec, <a class="el" href="struct_symm_info.html">SymmInfo</a> *symm)</td></tr>
<tr class="memdesc:a35a859f8103553086e4d95202950242f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Count the number of spin- and symmetry-allowed single excitations from a determinant.  <a href="#a35a859f8103553086e4d95202950242f">More...</a><br /></td></tr>
<tr class="separator:a35a859f8103553086e4d95202950242f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace6130812eeeb5a60dbd7ad5e70e8b61"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="molecule_8cpp.html#ace6130812eeeb5a60dbd7ad5e70e8b61">diag_matrel</a> (const uint8_t *occ_orbs, unsigned int n_orbs, const <a class="el" href="class_four_d_arr.html">FourDArr</a> &amp;eris, const <a class="el" href="class_matrix.html">Matrix</a>&lt; double &gt; &amp;h_core, unsigned int n_frozen, unsigned int n_elec)</td></tr>
<tr class="memdesc:ace6130812eeeb5a60dbd7ad5e70e8b61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate diagonal Hamiltonian matrix element for a Slater determinant.  <a href="#ace6130812eeeb5a60dbd7ad5e70e8b61">More...</a><br /></td></tr>
<tr class="separator:ace6130812eeeb5a60dbd7ad5e70e8b61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0e5ad0581e51fbae3985ef57beb3ffc"><td class="memItemLeft" align="right" valign="top"><a id="ad0e5ad0581e51fbae3985ef57beb3ffc"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>diag_matrel</b> (const uint8_t *occ_orbs, unsigned int n_orbs, const <a class="el" href="class_symm_e_r_is.html">SymmERIs</a> &amp;eris, const <a class="el" href="class_matrix.html">Matrix</a>&lt; double &gt; &amp;h_core, unsigned int n_frozen, unsigned int n_elec)</td></tr>
<tr class="separator:ad0e5ad0581e51fbae3985ef57beb3ffc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a161156a9756341b67fb2007c8fc2dd"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="molecule_8cpp.html#a3a161156a9756341b67fb2007c8fc2dd">find_nth_virt_symm</a> (uint8_t *det, uint8_t spin_orbs, uint8_t irrep, uint8_t n, const <a class="el" href="class_matrix.html">Matrix</a>&lt; uint8_t &gt; &amp;lookup_tabl)</td></tr>
<tr class="memdesc:a3a161156a9756341b67fb2007c8fc2dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the nth virtual orbital in a determinant with a particular spin and point-group symmetry.  <a href="#a3a161156a9756341b67fb2007c8fc2dd">More...</a><br /></td></tr>
<tr class="separator:a3a161156a9756341b67fb2007c8fc2dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09a5f7c5f8d5a3ff5e9b90fb315fdd6e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="molecule_8cpp.html#a09a5f7c5f8d5a3ff5e9b90fb315fdd6e">gen_symm_lookup</a> (uint8_t *orb_symm, <a class="el" href="class_matrix.html">Matrix</a>&lt; uint8_t &gt; &amp;lookup_tabl)</td></tr>
<tr class="memdesc:a09a5f7c5f8d5a3ff5e9b90fb315fdd6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a list of all spatial orbitals of each irrep in the point group.  <a href="#a09a5f7c5f8d5a3ff5e9b90fb315fdd6e">More...</a><br /></td></tr>
<tr class="separator:a09a5f7c5f8d5a3ff5e9b90fb315fdd6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9de32baa17ee9dc1f80c87b531ad20e8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="molecule_8cpp.html#a9de32baa17ee9dc1f80c87b531ad20e8">print_symm_lookup</a> (<a class="el" href="class_matrix.html">Matrix</a>&lt; uint8_t &gt; &amp;lookup_tabl)</td></tr>
<tr class="memdesc:a9de32baa17ee9dc1f80c87b531ad20e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print the orbitals in the spatial basis with each irrep.  <a href="#a9de32baa17ee9dc1f80c87b531ad20e8">More...</a><br /></td></tr>
<tr class="separator:a9de32baa17ee9dc1f80c87b531ad20e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Utilities for a Hamiltonian describing a molecular system. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a9f35451f0df2c2f5c32af37aef293c32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f35451f0df2c2f5c32af37aef293c32">&#9670;&nbsp;</a></span>count_doub_nosymm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t count_doub_nosymm </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>num_elec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>num_orb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate number of double excitations from any determinant accounting only for spin symmetry. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">num_elec</td><td>Number of electrons in the system </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">num_orb</td><td>Number of unfrozen spatial orbitals in the basis </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>number of double excitations </dd></dl>

</div>
</div>
<a id="a35a859f8103553086e4d95202950242f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35a859f8103553086e4d95202950242f">&#9670;&nbsp;</a></span>count_singex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t count_singex </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>det</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>occ_orbs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>num_elec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_symm_info.html">SymmInfo</a> *&#160;</td>
          <td class="paramname"><em>symm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Count the number of spin- and symmetry-allowed single excitations from a determinant. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">det</td><td>Bit-string representation of the origin determinant </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">occ_orbs</td><td>Array of occupied orbitals in <code>det</code> (length <code>num_elec</code>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">num_elec</td><td>Number of occupied orbitals in the determinant </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">symm</td><td>Object containing information about the symmetries of orbitals in the single-particle basis </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>number of symmetry-allowed single excitations </dd></dl>

</div>
</div>
<a id="ace6130812eeeb5a60dbd7ad5e70e8b61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace6130812eeeb5a60dbd7ad5e70e8b61">&#9670;&nbsp;</a></span>diag_matrel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double diag_matrel </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>occ_orbs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n_orbs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_four_d_arr.html">FourDArr</a> &amp;&#160;</td>
          <td class="paramname"><em>eris</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_matrix.html">Matrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_core</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n_frozen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n_elec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate diagonal Hamiltonian matrix element for a Slater determinant. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">occ_orbs</td><td>Array of occupied orbitals in the determinant (length <code>n_elec</code> - <code>n_frozen</code>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_orbs</td><td>Number of HF spatial orbitals (including frozen) in the basis </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eris</td><td>4-D array of 2-electron integrals in spatial MO basis </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h_core</td><td>2-D array of 1-electron integrals in spatial MO basis </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_frozen</td><td>number of core electrons frozen in the calculation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_elec</td><td>number of unfrozen electrons in the system </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>calculated matrix element </dd></dl>

</div>
</div>
<a id="ac98cb5204a85ad27106ece4c76a3ed7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac98cb5204a85ad27106ece4c76a3ed7d">&#9670;&nbsp;</a></span>doub_ex_symm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t doub_ex_symm </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>det</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>occ_orbs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>num_elec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>num_orb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>res_arr</em>[][4], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>symm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate all spin- and symmetry-allowed double excitations from a Slater determinant. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">det</td><td>Bit string representation of the origin determinant </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">occ_orbs</td><td>Array of occupied orbitals in <code>det</code> (length <code>num_elec</code>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">num_elec</td><td>Number of occupied orbitals in the determinant </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">num_orb</td><td>Number of unfrozen spatial HF orbitals in the basis </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">res_arr</td><td>2-d array containing the occupied (0th and 1st) and unoccupied (2nd and 3rd) orbitals defining each excitation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">symm</td><td>irrep of each of the orbitals in the HF basis </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>total number of excitations generated </dd></dl>

</div>
</div>
<a id="af024927565dbbf58e9d0531f16709ee0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af024927565dbbf58e9d0531f16709ee0">&#9670;&nbsp;</a></span>doub_matr_el_nosgn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double doub_matr_el_nosgn </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>chosen_orbs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n_orbs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_four_d_arr.html">FourDArr</a> &amp;&#160;</td>
          <td class="paramname"><em>eris</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n_frozen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate a double excitation matrix element. </p>
<p>The parity of the excitation, i.e. from the ordering of the orbitals, is not accounted for in this function</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">chosen_orbs</td><td>The indices of the two occupied orbitals (0th and 1st elements) and two virtual orbitals (2nd and 3rd elements) defining the excitation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_orbs</td><td>Number of HF spatial orbitals (including frozen) in the basis </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eris</td><td>4-D array of 2-electron integrals in spatial basis </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_frozen</td><td>Number of core electrons frozen in the calculation </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>calculated matrix element </dd></dl>

</div>
</div>
<a id="a3a161156a9756341b67fb2007c8fc2dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a161156a9756341b67fb2007c8fc2dd">&#9670;&nbsp;</a></span>find_nth_virt_symm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t find_nth_virt_symm </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>det</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>spin_orbs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>irrep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_matrix.html">Matrix</a>&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>lookup_tabl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the nth virtual orbital in a determinant with a particular spin and point-group symmetry. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">det</td><td>Bit-string representation of the origin determinant </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">spin_orbs</td><td>Spin of the orbital in question (0 or 1) times the number of spatial orbitals in the basis </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">irrep</td><td>The irrep of the orbital in question </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>The index of the virtual orbital in question </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lookup_tabl</td><td>List of orbitals with each type of symmetry, as generated by <a class="el" href="molecule_8hpp.html#a09a5f7c5f8d5a3ff5e9b90fb315fdd6e" title="Generate a list of all spatial orbitals of each irrep in the point group. ">gen_symm_lookup()</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The orbital index of the virtual orbital in question </dd></dl>

</div>
</div>
<a id="a71b5f31424693d76a470f94a367b4973"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71b5f31424693d76a470f94a367b4973">&#9670;&nbsp;</a></span>gen_hf_ex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t gen_hf_ex </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>hf_det</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>hf_occ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>num_elec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n_orb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>orb_symm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_four_d_arr.html">FourDArr</a> &amp;&#160;</td>
          <td class="paramname"><em>eris</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n_frozen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_matrix.html">Matrix</a>&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>ex_dets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>ex_mel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the HF column of the FCI Hamiltonian. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">hf_det</td><td>Bit-string representation of the HF determinant </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hf_occ</td><td>Orbitals occupied in the HF determinant (length <code>num_elec</code>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">num_elec</td><td>Number of occupied orbitals in the determinant </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_orb</td><td>Number of spatial orbitals in the basis (including frozen) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">orb_symm</td><td>Irrep of each spatial orbital in the basis </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eris</td><td>4-D array of 2-electron integrals in spatial basis </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_frozen</td><td>Number of core electrons frozen in the calculation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ex_dets</td><td>Slater determinant indices of elements in the HF column </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ex_mel</td><td>Elements in the column </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>total number of nonzero elements </dd></dl>

</div>
</div>
<a id="a09a5f7c5f8d5a3ff5e9b90fb315fdd6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09a5f7c5f8d5a3ff5e9b90fb315fdd6e">&#9670;&nbsp;</a></span>gen_symm_lookup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gen_symm_lookup </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>orb_symm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_matrix.html">Matrix</a>&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>lookup_tabl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate a list of all spatial orbitals of each irrep in the point group. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">orb_symm</td><td>Irrep of each orbital in the HF basis (length <code>n_orbs</code>) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">lookup_tabl</td><td>matrix whose 0th column lists number of orbitals with each irrep, and subsequent columns list those orbitals (dimensions n_symm x (<code>n_orb</code> + 1)) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa6a0e9701b587b34adfc0fca9130554c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6a0e9701b587b34adfc0fca9130554c">&#9670;&nbsp;</a></span>h_op_diag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void h_op_diag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_dist_vec.html">DistVec</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>dest_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>id_fac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>h_fac</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deterministically multiply a vector by the diagonal portion of (a * I + b * H), where H is the Hamiltonian and I is the identity This method multiplies a sub-vector within the inputted <a class="el" href="class_dist_vec.html" title="Class for storing and manipulating a sparse vector. ">DistVec</a> object, as determined by its <code>curr_vec_idx</code> instance variable. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">vec</td><td>upon return, contains the vector obtained by multiplying by H </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dest_idx</td><td>The index of the sub-vector in <code>vec</code> to store the result in </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id_fac</td><td>The constant pre-factor for the identity matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h_fac</td><td>The constant pre-factor for the Hamiltonian matrix </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1c69a34ba225f016e4e138c7cbed3fe7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c69a34ba225f016e4e138c7cbed3fe7">&#9670;&nbsp;</a></span>h_op_offdiag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void h_op_offdiag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_dist_vec.html">DistVec</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>vec_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>symm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n_orbs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_symm_e_r_is.html">SymmERIs</a> &amp;&#160;</td>
          <td class="paramname"><em>eris</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_matrix.html">Matrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_core</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>orbs_scratch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>scratch_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n_frozen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n_elec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>dest_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>h_fac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>spin_parity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deterministically multiply a vector by the off-diagonal elements of the Hamiltonian matrix times a constant factor This method multiplies a sub-vector within the inputted <a class="el" href="class_dist_vec.html" title="Class for storing and manipulating a sparse vector. ">DistVec</a> object, as determined by its <code>curr_vec_idx</code> instance variable. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">vec</td><td>upon return, contains the vector obtained by multiplying by H </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vec_size</td><td>If passed as an argument, only the first <code>vec_size</code> elements in <code>vec</code> will be considered in the multiplication by H </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">symm</td><td>irrep of each of the orbitals in the HF basis </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_orbs</td><td>Number of HF spatial orbitals (including frozen) in the basis </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eris</td><td>4-D array of 2-electron integrals in spatial basis </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h_core</td><td>2-D array of 1-electron integrals in spatial basis </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">orbs_scratch</td><td>Scratch array for storing the orbitals involved in the excitation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">scratch_size</td><td>Size in bytes of the memory at orbs_scratch </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_frozen</td><td>Number of core electrons frozen in the calculation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_elec</td><td>Number of unfrozen electrons in the system </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dest_idx</td><td>The index of the sub-vector in <code>vec</code> to store the result in </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h_fac</td><td>The constant factor used in the multiplication </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">spin_parity</td><td>1 if targeting even-spin states with time-reveral symmetry, -1 for odd-spin states, 0 if time-reversal symmetry is not used </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1ca322bdd6b3d5589e7523e8a182df0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ca322bdd6b3d5589e7523e8a182df0a">&#9670;&nbsp;</a></span>one_elec_op()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void one_elec_op </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_dist_vec.html">DistVec</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n_orbs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>des_op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>cre_op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>dest_idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deterministically multiply a vector by a 1-electron operator a^ a_q. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">vec</td><td>upon return, contains the vector obtained by multiplying by the 1-electron operator </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_orbs</td><td>Number of HF unfrozen spatial orbitals in the basis </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">des_op</td><td>Orbital index of the destruction operator component of the 1-electron operator </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cre_op</td><td>Orbital index of the creation operator component of the 1-electron operator </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dest_idx</td><td>The index of the sub-vector in <code>vec</code> to store the result in </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9de32baa17ee9dc1f80c87b531ad20e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9de32baa17ee9dc1f80c87b531ad20e8">&#9670;&nbsp;</a></span>print_symm_lookup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void print_symm_lookup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_matrix.html">Matrix</a>&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>lookup_tabl</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print the orbitals in the spatial basis with each irrep. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lookup_tabl</td><td>Symmetry table generated by <a class="el" href="molecule_8hpp.html#a09a5f7c5f8d5a3ff5e9b90fb315fdd6e" title="Generate a list of all spatial orbitals of each irrep in the point group. ">gen_symm_lookup()</a> </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="abcd8b7de96bcaf419abbaf9ec393c7c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abcd8b7de96bcaf419abbaf9ec393c7c4">&#9670;&nbsp;</a></span>sing_ex_symm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t sing_ex_symm </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>det</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>occ_orbs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>num_elec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>num_orb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>res_arr</em>[][2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>symm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate all spin- and symmetry-allowed single excitations from a Slater determinant. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">det</td><td>Bit string representation of the origin determinant </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">occ_orbs</td><td>Array of occupied orbitals in <code>det</code> (length <code>num_elec</code>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">num_elec</td><td>Number of occupied orbitals in the determinant </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">num_orb</td><td>Number of unfrozen spatial HF orbitals in the basis </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">res_arr</td><td>2-d array containing the occupied (0th) and unoccupied (1st) orbitals defining each excitation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">symm</td><td>irrep of each of the orbitals in the HF basis </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>total number of excitations generated </dd></dl>

</div>
</div>
<a id="a20cdcf19c43532b4aeac5cef2f9c9a38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20cdcf19c43532b4aeac5cef2f9c9a38">&#9670;&nbsp;</a></span>sing_matr_el_nosgn()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double sing_matr_el_nosgn </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>chosen_orbs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>occ_orbs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n_orbs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_four_d_arr.html">FourDArr</a> &amp;&#160;</td>
          <td class="paramname"><em>eris</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_matrix.html">Matrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>h_core</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n_frozen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n_elec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate a single excitation matrix element. </p>
<p>The parity of the excitation, i.e. from the ordering of the orbitals, is not accounted for in this function</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">chosen_orbs</td><td>The indices of the occupied orbital (0th element) and virtual orbital (1st element) defining the excitation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">occ_orbs</td><td>Orbitals occupied in the origin determinant (length <code>n_elec</code>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_orbs</td><td>Number of HF spatial orbitals (including frozen) in the basis </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eris</td><td>4-D array of 2-electron integrals in spatial basis </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h_core</td><td>2-D array of 1-electron integrals in spatial basis </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_frozen</td><td>Number of core electrons frozen in the calculation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_elec</td><td>Number of unfrozen electrons in the system </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>calculated matrix element </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
