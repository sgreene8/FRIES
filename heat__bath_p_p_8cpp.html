<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Fast Randomized Iteration for Electronic Structure: /home/travis/build/sgreene8/FRIES/FRIES/Hamiltonians/heat_bathPP.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Fast Randomized Iteration for Electronic Structure
   </div>
   <div id="projectbrief">An implementation of FRI methods for quantum chemistry</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_607347b14e208e050cf2976c6f5bb11f.html">FRIES</a></li><li class="navelem"><a class="el" href="dir_881573b67d992baba3d2ba4317bef69e.html">Hamiltonians</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">heat_bathPP.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Utilities for Heat-Bath Power-Pitzer compression of Hamiltonian.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="heat__bath_p_p_8hpp_source.html">heat_bathPP.hpp</a>&quot;</code><br />
<code>#include &lt;<a class="el" href="det__store_8h_source.html">FRIES/det_store.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="molecule_8hpp_source.html">FRIES/Hamiltonians/molecule.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="math__utils_8h_source.html">FRIES/math_utils.h</a>&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae197863d9c7bd5340b7f86e840b92207"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structhb__info.html">hb_info</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heat__bath_p_p_8cpp.html#ae197863d9c7bd5340b7f86e840b92207">set_up</a> (unsigned int tot_orb, unsigned int n_orb, const <a class="el" href="class_four_d_arr.html">FourDArr</a> &amp;eris)</td></tr>
<tr class="memdesc:ae197863d9c7bd5340b7f86e840b92207"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate terms in the HB-PP factorization from two-electron integrals from Hartree-Fock.  <a href="#ae197863d9c7bd5340b7f86e840b92207">More...</a><br /></td></tr>
<tr class="separator:ae197863d9c7bd5340b7f86e840b92207"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa0832c808e0576b4e98207c46e57f75"><td class="memItemLeft" align="right" valign="top"><a id="aaa0832c808e0576b4e98207c46e57f75"></a>
<a class="el" href="structhb__info.html">hb_info</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>set_up</b> (uint32_t tot_orb, uint32_t n_orb, const <a class="el" href="class_symm_e_r_is.html">SymmERIs</a> &amp;eris)</td></tr>
<tr class="separator:aaa0832c808e0576b4e98207c46e57f75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab35887a26bf2a0198bcb8a0415524192"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heat__bath_p_p_8cpp.html#ab35887a26bf2a0198bcb8a0415524192">calc_o1_probs</a> (<a class="el" href="structhb__info.html">hb_info</a> *tens, double *prob_arr, unsigned int n_elec, uint8_t *occ_orbs, int exclude_first)</td></tr>
<tr class="memdesc:ab35887a26bf2a0198bcb8a0415524192"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the normalized probabilities for choosing the first occupied orbital in a double excitation from a particular determinant.  <a href="#ab35887a26bf2a0198bcb8a0415524192">More...</a><br /></td></tr>
<tr class="separator:ab35887a26bf2a0198bcb8a0415524192"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3553781e565f7d08a8e27899787ee66c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heat__bath_p_p_8cpp.html#a3553781e565f7d08a8e27899787ee66c">calc_o2_probs</a> (<a class="el" href="structhb__info.html">hb_info</a> *tens, double *prob_arr, unsigned int n_elec, uint8_t *occ_orbs, uint8_t o1_idx)</td></tr>
<tr class="memdesc:a3553781e565f7d08a8e27899787ee66c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the normalized probabilities for choosing the second occupied orbital in a double excitation from a particular determinant.  <a href="#a3553781e565f7d08a8e27899787ee66c">More...</a><br /></td></tr>
<tr class="separator:a3553781e565f7d08a8e27899787ee66c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6229287a43b7d64003ce1cab2ed897c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heat__bath_p_p_8cpp.html#ac6229287a43b7d64003ce1cab2ed897c">calc_o2_probs_half</a> (<a class="el" href="structhb__info.html">hb_info</a> *tens, double *prob_arr, unsigned int n_elec, uint8_t *occ_orbs, uint8_t o1_idx)</td></tr>
<tr class="memdesc:ac6229287a43b7d64003ce1cab2ed897c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the normalized probabilities for choosing the second occupied orbital in a double excitation, with the constraint that the orbital is less than the first occupied orbital.  <a href="#ac6229287a43b7d64003ce1cab2ed897c">More...</a><br /></td></tr>
<tr class="separator:ac6229287a43b7d64003ce1cab2ed897c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a581eda3a9c7322d5d84e34ce43faec19"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heat__bath_p_p_8cpp.html#a581eda3a9c7322d5d84e34ce43faec19">calc_u1_probs</a> (<a class="el" href="structhb__info.html">hb_info</a> *tens, double *prob_arr, uint8_t o1_orb, uint8_t *occ_orbs, uint8_t n_elec, int exclude_first)</td></tr>
<tr class="memdesc:a581eda3a9c7322d5d84e34ce43faec19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the normalized probabilities for choosing the first unoccupied orbital in a double excitation from a particular determinant.  <a href="#a581eda3a9c7322d5d84e34ce43faec19">More...</a><br /></td></tr>
<tr class="separator:a581eda3a9c7322d5d84e34ce43faec19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac18603382613e5c22711b23521b0ee03"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heat__bath_p_p_8cpp.html#ac18603382613e5c22711b23521b0ee03">calc_u2_probs</a> (<a class="el" href="structhb__info.html">hb_info</a> *tens, double *prob_arr, uint8_t o1_orb, uint8_t o2_orb, uint8_t u1_orb, <a class="el" href="struct_symm_info.html">SymmInfo</a> *symm_struct, uint16_t *prob_len)</td></tr>
<tr class="memdesc:ac18603382613e5c22711b23521b0ee03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the normalized probabilities for choosing the second unoccupied orbital in a double excitation from a particular determinant.  <a href="#ac18603382613e5c22711b23521b0ee03">More...</a><br /></td></tr>
<tr class="separator:ac18603382613e5c22711b23521b0ee03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f7a0d144b925cf0cc2f6529be027aa9"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heat__bath_p_p_8cpp.html#a6f7a0d144b925cf0cc2f6529be027aa9">calc_u2_probs_half</a> (<a class="el" href="structhb__info.html">hb_info</a> *tens, double *prob_arr, uint8_t o1_orb, uint8_t o2_orb, uint8_t u1_orb, uint8_t *det, <a class="el" href="struct_symm_info.html">SymmInfo</a> *symm_struct, uint16_t *prob_len)</td></tr>
<tr class="memdesc:a6f7a0d144b925cf0cc2f6529be027aa9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate normalized weights for the second unoccupied orbital, excluding occupied orbitals and requiring that the second unoccupied orbital index be less than that of the first.  <a href="#a6f7a0d144b925cf0cc2f6529be027aa9">More...</a><br /></td></tr>
<tr class="separator:a6f7a0d144b925cf0cc2f6529be027aa9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8e57ae0ff2241fb5f66ee79e71546d1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heat__bath_p_p_8cpp.html#ad8e57ae0ff2241fb5f66ee79e71546d1">calc_unnorm_wt</a> (<a class="el" href="structhb__info.html">hb_info</a> *tens, uint8_t *orbs)</td></tr>
<tr class="memdesc:ad8e57ae0ff2241fb5f66ee79e71546d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the unnormalized weight for a double excitation from a particular determinant.  <a href="#ad8e57ae0ff2241fb5f66ee79e71546d1">More...</a><br /></td></tr>
<tr class="separator:ad8e57ae0ff2241fb5f66ee79e71546d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8fa65d8e57d16f8def67b5011fbbd8f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heat__bath_p_p_8cpp.html#af8fa65d8e57d16f8def67b5011fbbd8f">calc_norm_wt</a> (<a class="el" href="structhb__info.html">hb_info</a> *tens, uint8_t *orbs, uint8_t *occ, unsigned int n_elec, uint8_t *det, <a class="el" href="struct_symm_info.html">SymmInfo</a> *symm)</td></tr>
<tr class="memdesc:af8fa65d8e57d16f8def67b5011fbbd8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the normalized weight for a double excitation from a particular determinant.  <a href="#af8fa65d8e57d16f8def67b5011fbbd8f">More...</a><br /></td></tr>
<tr class="separator:af8fa65d8e57d16f8def67b5011fbbd8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7de70662798007df3cf273bdf85f0e7b"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heat__bath_p_p_8cpp.html#a7de70662798007df3cf273bdf85f0e7b">hb_doub_multi</a> (uint8_t *det, uint8_t *occ_orbs, unsigned int num_elec, <a class="el" href="struct_symm_info.html">SymmInfo</a> *symm, <a class="el" href="structhb__info.html">hb_info</a> *tens, unsigned int num_sampl, std::mt19937 &amp;mt_obj, uint8_t(*chosen_orbs)[4], double *prob_vec)</td></tr>
<tr class="memdesc:a7de70662798007df3cf273bdf85f0e7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform multinomial sampling on the double excitation part of the Hamiltonian matrix using the heat-bath Power-Pitzer factorization.  <a href="#a7de70662798007df3cf273bdf85f0e7b">More...</a><br /></td></tr>
<tr class="separator:a7de70662798007df3cf273bdf85f0e7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af127e56bdb269abdd815c5e6cd418c6d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heat__bath_p_p_8cpp.html#af127e56bdb269abdd815c5e6cd418c6d">apply_HBPP_sys</a> (<a class="el" href="class_matrix.html">Matrix</a>&lt; uint8_t &gt; &amp;all_orbs, <a class="el" href="class_matrix.html">Matrix</a>&lt; uint8_t &gt; &amp;all_dets, <a class="el" href="struct_h_b_compress_sys.html">HBCompressSys</a> *comp_scratch, <a class="el" href="structhb__info.html">hb_info</a> *hb_probs, <a class="el" href="struct_symm_info.html">SymmInfo</a> *symm, double p_doub, bool new_hb, std::mt19937 &amp;mt_obj, uint32_t n_samp, std::function&lt; double(uint8_t *, uint8_t *)&gt; sing_mat_fxn, std::function&lt; double(uint8_t *)&gt; doub_mat_fxn)</td></tr>
<tr class="memdesc:af127e56bdb269abdd815c5e6cd418c6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply the heat-bath power-pitzer Hamiltonian matrix factors to an initial vector, applying systematic compression after multiplication by each factor (except the last)  <a href="#af127e56bdb269abdd815c5e6cd418c6d">More...</a><br /></td></tr>
<tr class="separator:af127e56bdb269abdd815c5e6cd418c6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0452f3328d20a8b5a1d79ee64bd6e89b"><td class="memItemLeft" align="right" valign="top"><a id="a0452f3328d20a8b5a1d79ee64bd6e89b"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><b>collapse_long_</b> (std::vector&lt; double &gt; &amp;short_vec, std::vector&lt; double &gt; &amp;long_vec, size_t short_len, size_t long_len, std::vector&lt; bool &gt; &amp;keep_vec, std::vector&lt; uint16_t &gt; &amp;group_sizes, std::function&lt; void(size_t, size_t, size_t)&gt; transfer_fxn)</td></tr>
<tr class="separator:a0452f3328d20a8b5a1d79ee64bd6e89b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b46c0542cdd9e4e3e9902f5f8409b7c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="heat__bath_p_p_8cpp.html#a6b46c0542cdd9e4e3e9902f5f8409b7c">apply_HBPP_piv</a> (<a class="el" href="class_matrix.html">Matrix</a>&lt; uint8_t &gt; &amp;all_orbs, <a class="el" href="class_matrix.html">Matrix</a>&lt; uint8_t &gt; &amp;all_dets, <a class="el" href="struct_h_b_compress_piv.html">HBCompressPiv</a> *comp_scratch, <a class="el" href="structhb__info.html">hb_info</a> *hb_probs, <a class="el" href="struct_symm_info.html">SymmInfo</a> *symm, double p_doub, bool new_hb, std::mt19937 &amp;mt_obj, uint32_t n_samp, std::function&lt; double(uint8_t *, uint8_t *)&gt; sing_mat_fxn, std::function&lt; double(uint8_t *)&gt; doub_mat_fxn, int spin_parity)</td></tr>
<tr class="memdesc:a6b46c0542cdd9e4e3e9902f5f8409b7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply the heat-bath power-pitzer Hamiltonian matrix factors to an initial vector, applying systematic compression after multiplication by each factor (except the last)  <a href="#a6b46c0542cdd9e4e3e9902f5f8409b7c">More...</a><br /></td></tr>
<tr class="separator:a6b46c0542cdd9e4e3e9902f5f8409b7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Utilities for Heat-Bath Power-Pitzer compression of Hamiltonian. </p>
<p>These functions apply only to the double excitation portion of a molecular Hamiltonian matrix. Single excitations are treated as in the near-uniform scheme </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a6b46c0542cdd9e4e3e9902f5f8409b7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b46c0542cdd9e4e3e9902f5f8409b7c">&#9670;&nbsp;</a></span>apply_HBPP_piv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void apply_HBPP_piv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_matrix.html">Matrix</a>&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>all_orbs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_matrix.html">Matrix</a>&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>all_dets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_h_b_compress_piv.html">HBCompressPiv</a> *&#160;</td>
          <td class="paramname"><em>comp_scratch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structhb__info.html">hb_info</a> *&#160;</td>
          <td class="paramname"><em>hb_probs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_symm_info.html">SymmInfo</a> *&#160;</td>
          <td class="paramname"><em>symm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p_doub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>new_hb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::mt19937 &amp;&#160;</td>
          <td class="paramname"><em>mt_obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>n_samp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; double(uint8_t *, uint8_t *)&gt;&#160;</td>
          <td class="paramname"><em>sing_mat_fxn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; double(uint8_t *)&gt;&#160;</td>
          <td class="paramname"><em>doub_mat_fxn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>spin_parity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply the heat-bath power-pitzer Hamiltonian matrix factors to an initial vector, applying systematic compression after multiplication by each factor (except the last) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">all_orbs</td><td>A matrix containing the occupied orbitals for each element in the initial vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">all_dets</td><td>A matrix containing the bit-string representations of each determinant in the initial vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">comp_scratch</td><td>Structure containing the intermediate vectors to use in the compression </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hb_probs</td><td>Structure containing the precomputed HB-PP probabilities </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">symm</td><td>Structure containing the symmetry information about the one-particle basis </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p_doub</td><td>The probability of selecting a generic double excitation (defined in the HB-PP factorization) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">new_hb</td><td>Specifies whether to use the modified HB-PP factorization defined in Greene et al. (2020) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mt_obj</td><td>For generating random numbers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_samp</td><td>Number of nonzero elements to keep in compression operations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sing_mat_fxn</td><td>Returns the Hamiltonian matrix element for a single excitation (without parity) given the orbitals involved in the excitation and the occupied orbitals in the origin determinant </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">doub_mat_fxn</td><td>Returns the Hamiltonian matrix element for a double excitation (without parity) given the orbitals involved in the excitation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">spin_parity</td><td>1 if targeting even-spin states with time-reveral symmetry, -1 for odd-spin states, 0 if time-reversal symmetry is not used </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af127e56bdb269abdd815c5e6cd418c6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af127e56bdb269abdd815c5e6cd418c6d">&#9670;&nbsp;</a></span>apply_HBPP_sys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void apply_HBPP_sys </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_matrix.html">Matrix</a>&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>all_orbs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_matrix.html">Matrix</a>&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>all_dets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_h_b_compress_sys.html">HBCompressSys</a> *&#160;</td>
          <td class="paramname"><em>comp_scratch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structhb__info.html">hb_info</a> *&#160;</td>
          <td class="paramname"><em>hb_probs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_symm_info.html">SymmInfo</a> *&#160;</td>
          <td class="paramname"><em>symm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p_doub</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>new_hb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::mt19937 &amp;&#160;</td>
          <td class="paramname"><em>mt_obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>n_samp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; double(uint8_t *, uint8_t *)&gt;&#160;</td>
          <td class="paramname"><em>sing_mat_fxn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; double(uint8_t *)&gt;&#160;</td>
          <td class="paramname"><em>doub_mat_fxn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply the heat-bath power-pitzer Hamiltonian matrix factors to an initial vector, applying systematic compression after multiplication by each factor (except the last) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">all_orbs</td><td>A matrix containing the occupied orbitals for each element in the initial vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">all_dets</td><td>A matrix containing the bit-string representations of each determinant in the initial vector </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">comp_scratch</td><td>Structure containing the intermediate vectors to use in the compression </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hb_probs</td><td>Structure containing the precomputed HB-PP probabilities </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">symm</td><td>Structure containing the symmetry information about the one-particle basis </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p_doub</td><td>The probability of selecting a generic double excitation (defined in the HB-PP factorization) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">new_hb</td><td>Specifies whether to use the modified HB-PP factorization defined in Greene et al. (2020) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mt_obj</td><td>For generating random numbers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_samp</td><td>Number of nonzero elements to keep in compression operations </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sing_mat_fxn</td><td>Returns the Hamiltonian matrix element for a single excitation (without parity) given the orbitals involved in the excitation and the occupied orbitals in the origin determinant </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">doub_mat_fxn</td><td>Returns the Hamiltonian matrix element for a double excitation (without parity) given the orbitals involved in the excitation </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af8fa65d8e57d16f8def67b5011fbbd8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8fa65d8e57d16f8def67b5011fbbd8f">&#9670;&nbsp;</a></span>calc_norm_wt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double calc_norm_wt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhb__info.html">hb_info</a> *&#160;</td>
          <td class="paramname"><em>tens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>orbs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>occ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n_elec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>det</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_symm_info.html">SymmInfo</a> *&#160;</td>
          <td class="paramname"><em>symm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the normalized weight for a double excitation from a particular determinant. </p>
<p>This function accounts for the different possible ways a double excitation can be selected, based on the order of the occupied and unoccupied orbitals. The weights are normalized at each level of the hierarchical construction.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tens</td><td><a class="el" href="structhb__info.html" title="Data structure used to store the elements defining the intermediate matrices in the HB-PP factorizati...">hb_info</a> struct containing the HB-PP parameters </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">orbs</td><td>Array containing the 2 occupied and 2 unoccupied orbitals defining the excitation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">occ</td><td>List of occupied orbitals in <code>det</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_elec</td><td>Number of occupied orbitals in <code>det</code> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">det</td><td>Origin determinant for the excitation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">symm</td><td>Object containing information about the symmetries of orbitals in the single-particle basis </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the weight for the excitation </dd></dl>

</div>
</div>
<a id="ab35887a26bf2a0198bcb8a0415524192"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab35887a26bf2a0198bcb8a0415524192">&#9670;&nbsp;</a></span>calc_o1_probs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double calc_o1_probs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhb__info.html">hb_info</a> *&#160;</td>
          <td class="paramname"><em>tens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>prob_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n_elec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>occ_orbs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>exclude_first</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the normalized probabilities for choosing the first occupied orbital in a double excitation from a particular determinant. </p>
<p>The probabilities for the first occupied orbital are given as: </p><p class="formulaDsp">
\[ P_i = \frac{S_i}{\sum_{j \in \text{occ}} S_j} \]
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tens</td><td><a class="el" href="structhb__info.html" title="Data structure used to store the elements defining the intermediate matrices in the HB-PP factorizati...">hb_info</a> struct containing the HB-PP parameters </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">prob_arr</td><td>probability for each occupied orbital (length <code>n_elec</code>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_elec</td><td>Number of electrons in the determinant </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">occ_orbs</td><td>array containing the indices of occupied orbitals in the determinant (length <code>n_elec</code>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">exclude_first</td><td>If 1, the first occupied orbital in the determinant is excluded </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>sum of all single-electron weights before normalization </dd></dl>

</div>
</div>
<a id="a3553781e565f7d08a8e27899787ee66c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3553781e565f7d08a8e27899787ee66c">&#9670;&nbsp;</a></span>calc_o2_probs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double calc_o2_probs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhb__info.html">hb_info</a> *&#160;</td>
          <td class="paramname"><em>tens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>prob_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n_elec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>occ_orbs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>o1_idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the normalized probabilities for choosing the second occupied orbital in a double excitation from a particular determinant. </p>
<p>The probabilities for the second occupied orbital given the selection of the first occupied orbital \( i \) are </p><p class="formulaDsp">
\[ P_j = \frac{D_{ij}}{\sum_{j&#39; \in \text{occ}} D_{ij&#39;}} \]
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tens</td><td><a class="el" href="structhb__info.html" title="Data structure used to store the elements defining the intermediate matrices in the HB-PP factorizati...">hb_info</a> struct containing the HB-PP parameters </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">prob_arr</td><td>probability for each occupied orbital (length <code>n_elec</code>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_elec</td><td>Number of electrons in the determinant </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">occ_orbs</td><td>array containing the indices of occupied orbitals in the determinant (length <code>n_elec</code>) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">o1_idx</td><td>The index of the first occupied orbital </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>sum of all single-electron weights before normalization </dd></dl>

</div>
</div>
<a id="ac6229287a43b7d64003ce1cab2ed897c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6229287a43b7d64003ce1cab2ed897c">&#9670;&nbsp;</a></span>calc_o2_probs_half()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double calc_o2_probs_half </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhb__info.html">hb_info</a> *&#160;</td>
          <td class="paramname"><em>tens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>prob_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n_elec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>occ_orbs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>o1_idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the normalized probabilities for choosing the second occupied orbital in a double excitation, with the constraint that the orbital is less than the first occupied orbital. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tens</td><td><a class="el" href="structhb__info.html" title="Data structure used to store the elements defining the intermediate matrices in the HB-PP factorizati...">hb_info</a> struct containing the HB-PP parameters </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">prob_arr</td><td>probability for each occupied orbital (length <code>n_elec</code>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_elec</td><td>Number of electrons in the determinant </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">occ_orbs</td><td>array containing the indices of occupied orbitals in the determinant (length <code>n_elec</code>) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">o1_idx</td><td>The index of the first occupied orbital </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>sum of all single-electron weights before normalization </dd></dl>

</div>
</div>
<a id="a581eda3a9c7322d5d84e34ce43faec19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a581eda3a9c7322d5d84e34ce43faec19">&#9670;&nbsp;</a></span>calc_u1_probs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double calc_u1_probs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhb__info.html">hb_info</a> *&#160;</td>
          <td class="paramname"><em>tens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>prob_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>o1_orb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>occ_orbs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>n_elec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>exclude_first</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the normalized probabilities for choosing the first unoccupied orbital in a double excitation from a particular determinant. </p>
<p>The probabilities for the first unoccupied orbital are </p><p class="formulaDsp">
\[ P_a = \frac{|\langle i a | a i \rangle|^{1/2}}{\sum_{c \in \lbrace \text{virt} \rbrace} |\langle i c | c i \rangle|^{1/2}} \]
</p>
<p> where i is the first occupied orbital selected previously.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tens</td><td><a class="el" href="structhb__info.html" title="Data structure used to store the elements defining the intermediate matrices in the HB-PP factorizati...">hb_info</a> struct containing the HB-PP parameters </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">prob_arr</td><td>probability for each unoccupied orbital (length n_orb) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">o1_orb</td><td>first occupied orbital (selected previously) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">occ_orbs</td><td>list of all occupied orbitals in the determinant </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_elec</td><td>Number of electrons in the determinant </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">exclude_first</td><td>If 1, the first occupied orbital in the determinant is excluded </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>sum of weights for all unoccupied orbitals before normalization </dd></dl>

</div>
</div>
<a id="ac18603382613e5c22711b23521b0ee03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac18603382613e5c22711b23521b0ee03">&#9670;&nbsp;</a></span>calc_u2_probs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double calc_u2_probs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhb__info.html">hb_info</a> *&#160;</td>
          <td class="paramname"><em>tens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>prob_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>o1_orb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>o2_orb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>u1_orb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_symm_info.html">SymmInfo</a> *&#160;</td>
          <td class="paramname"><em>symm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>prob_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the normalized probabilities for choosing the second unoccupied orbital in a double excitation from a particular determinant. </p>
<p>The probabilities are defined similarly as for the first unoccupied orbital, except that the sum is over the symmetry-allowed orbitals (not necessarily unoccupied) in the basis</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tens</td><td><a class="el" href="structhb__info.html" title="Data structure used to store the elements defining the intermediate matrices in the HB-PP factorizati...">hb_info</a> struct containing the HB-PP parameters </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">prob_arr</td><td>probability for each unoccupied orbital </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">o1_orb</td><td>first occupied orbital (selected previously) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">o2_orb</td><td>second occupied orbital (selected previously) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u1_orb</td><td>first unoccupied orbital (selected previously) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">symm</td><td>Object containing information about the symmetries of orbitals in the single-particle basis </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">prob_len</td><td>If points to 0, set to the number of irreps in the corresponding row of <code>lookup_tabl</code>; Otherwise, taken to indicate the length of <code>prob_arr</code>, such additional elements in prob_len beyond the number of irreps are zeroed. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>sum of weights for all unoccupied orbitals before normalization </dd></dl>

</div>
</div>
<a id="a6f7a0d144b925cf0cc2f6529be027aa9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f7a0d144b925cf0cc2f6529be027aa9">&#9670;&nbsp;</a></span>calc_u2_probs_half()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double calc_u2_probs_half </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhb__info.html">hb_info</a> *&#160;</td>
          <td class="paramname"><em>tens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>prob_arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>o1_orb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>o2_orb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>u1_orb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>det</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_symm_info.html">SymmInfo</a> *&#160;</td>
          <td class="paramname"><em>symm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>prob_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate normalized weights for the second unoccupied orbital, excluding occupied orbitals and requiring that the second unoccupied orbital index be less than that of the first. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tens</td><td><a class="el" href="structhb__info.html" title="Data structure used to store the elements defining the intermediate matrices in the HB-PP factorizati...">hb_info</a> struct containing the HB-PP parameters </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">prob_arr</td><td>probability for each unoccupied orbital </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">o1_orb</td><td>first occupied orbital (selected previously) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">o2_orb</td><td>second occupied orbital (selected previously) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u1_orb</td><td>first unoccupied orbital (selected previously) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">det</td><td>Bit-string representation of determinant </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">symm</td><td>Object containing information about the symmetries of orbitals in the single-particle basis </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">prob_len</td><td>If points to 0, set to the number of irreps in the corresponding row of <code>lookup_tabl</code>; Otherwise, taken to indicate the length of <code>prob_arr</code>, such additional elements in prob_len beyond the number of irreps are zeroed. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>sum of weights for all unoccupied orbitals before normalization </dd></dl>

</div>
</div>
<a id="ad8e57ae0ff2241fb5f66ee79e71546d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8e57ae0ff2241fb5f66ee79e71546d1">&#9670;&nbsp;</a></span>calc_unnorm_wt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double calc_unnorm_wt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structhb__info.html">hb_info</a> *&#160;</td>
          <td class="paramname"><em>tens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>orbs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the unnormalized weight for a double excitation from a particular determinant. </p>
<p>This function accounts for the different possible ways a double excitation can be selected, based on the order of the occupied and unoccupied orbitals.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tens</td><td><a class="el" href="structhb__info.html" title="Data structure used to store the elements defining the intermediate matrices in the HB-PP factorizati...">hb_info</a> struct containing the HB-PP parameters </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">orbs</td><td>Array containing the 2 occupied and 2 unoccupied orbitals defining the excitation </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the weight for the excitation </dd></dl>

</div>
</div>
<a id="a7de70662798007df3cf273bdf85f0e7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7de70662798007df3cf273bdf85f0e7b">&#9670;&nbsp;</a></span>hb_doub_multi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int hb_doub_multi </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>det</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>occ_orbs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>num_elec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_symm_info.html">SymmInfo</a> *&#160;</td>
          <td class="paramname"><em>symm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structhb__info.html">hb_info</a> *&#160;</td>
          <td class="paramname"><em>tens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>num_sampl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::mt19937 &amp;&#160;</td>
          <td class="paramname"><em>mt_obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t(*)&#160;</td>
          <td class="paramname"><em>chosen_orbs</em>[4], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>prob_vec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Perform multinomial sampling on the double excitation part of the Hamiltonian matrix using the heat-bath Power-Pitzer factorization. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">det</td><td>bit string representation of the origin determinant defining the respective column of the Hamiltonian </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">occ_orbs</td><td>list of occupied orbitals in det (length <code>num_elec</code>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">num_elec</td><td>number of occupied orbitals in det </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tens</td><td><a class="el" href="structhb__info.html" title="Data structure used to store the elements defining the intermediate matrices in the HB-PP factorizati...">hb_info</a> struct containing the HB-PP parameters </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">symm</td><td>Object containing information about the symmetries of orbitals in the single-particle basis </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">num_sampl</td><td>number of double excitations to sample from the column </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mt_obj</td><td>Reference to an initialized MT object for RN generation </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">chosen_orbs</td><td>Contains occupied (0th and 1st columns) and unoccupied (2nd and 3rd columns) orbitals for each excitation (dimensions num_sampl x 4) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">prob_vec</td><td>Contains probability for each excitation (length num_sampl) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>number of excitations sampled (less than num_sampl if some excitations were null) </dd></dl>

</div>
</div>
<a id="ae197863d9c7bd5340b7f86e840b92207"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae197863d9c7bd5340b7f86e840b92207">&#9670;&nbsp;</a></span>set_up()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structhb__info.html">hb_info</a>* set_up </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>tot_orb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n_orb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_four_d_arr.html">FourDArr</a> &amp;&#160;</td>
          <td class="paramname"><em>eris</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate terms in the HB-PP factorization from two-electron integrals from Hartree-Fock. </p>
<p>Double-electron components are defined for \( p \neq q \) as </p><p class="formulaDsp">
\[ D_{pq} = \sum_{r,s \notin \lbrace p, q \rbrace} \left\lvert \langle p q || r s \rangle \right\rvert \]
</p>
<p> Single-electron components are defined as \( S_p = \sum_{q} D_{pq} \)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tot_orb</td><td>number of spatial orbitals from Hartree-Fock </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_orb</td><td>number of unfrozen spatial orbitals to use in constructing single- and double-electron components </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eris</td><td>2-electron integrals </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structhb__info.html" title="Data structure used to store the elements defining the intermediate matrices in the HB-PP factorizati...">hb_info</a> struct initialized with the HB-PP parameters </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
