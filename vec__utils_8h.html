<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Fast Randomized Iteration for Electronic Structure: /Users/samuelgreene/Documents/U of C Research/C code/FRIes/FRIES/vec_utils.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Fast Randomized Iteration for Electronic Structure
   </div>
   <div id="projectbrief">An implementation of FRI methods for quantum chemistry</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_607347b14e208e050cf2976c6f5bb11f.html">FRIES</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">vec_utils.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Utilities for storing and manipulating sparse vectors.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;<a class="el" href="det__store_8h_source.html">FRIES/det_store.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="hub__holstein_8h_source.html">FRIES/Hamiltonians/hub_holstein.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="dc_8h_source.html">FRIES/Ext_Libs/dcmt/dc.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="mpi__switch_8h_source.html">FRIES/mpi_switch.h</a>&gt;</code><br />
</div>
<p><a href="vec__utils_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structadder.html">adder</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Struct used to add elements to sparse vector.  <a href="structadder.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdist__vec.html">dist_vec</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Struct for storing a sparse vector.  <a href="structdist__vec.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aed580ea34c25917782168ed22fef2590"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structadder.html">adder</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vec__utils_8h.html#aed580ea34c25917782168ed22fef2590">init_adder</a> (size_t size, dtype type)</td></tr>
<tr class="memdesc:aed580ea34c25917782168ed22fef2590"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup an adder struct.  <a href="vec__utils_8h.html#aed580ea34c25917782168ed22fef2590">More...</a><br /></td></tr>
<tr class="separator:aed580ea34c25917782168ed22fef2590"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b532066b2b1bc46153e98858b0dd938"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structdist__vec.html">dist_vec</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vec__utils_8h.html#a7b532066b2b1bc46153e98858b0dd938">init_vec</a> (size_t size, size_t add_size, <a class="el" href="structmt__struct.html">mt_struct</a> *rn_ptr, unsigned int n_orb, unsigned int n_elec, dtype vec_type, int n_sites)</td></tr>
<tr class="memdesc:a7b532066b2b1bc46153e98858b0dd938"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up a <a class="el" href="structdist__vec.html" title="Struct for storing a sparse vector.">dist_vec</a> struct.  <a href="vec__utils_8h.html#a7b532066b2b1bc46153e98858b0dd938">More...</a><br /></td></tr>
<tr class="separator:a7b532066b2b1bc46153e98858b0dd938"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad8dfe7b8eaeacd51213bc706e6d22fd"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vec__utils_8h.html#aad8dfe7b8eaeacd51213bc706e6d22fd">vec_dot</a> (<a class="el" href="structdist__vec.html">dist_vec</a> *vec, long long *idx2, double *vals2, size_t num2, unsigned long long *hashes2)</td></tr>
<tr class="memdesc:aad8dfe7b8eaeacd51213bc706e6d22fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate dot product.  <a href="vec__utils_8h.html#aad8dfe7b8eaeacd51213bc706e6d22fd">More...</a><br /></td></tr>
<tr class="separator:aad8dfe7b8eaeacd51213bc706e6d22fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0466f61ff76fc5d1182b1ddc3de08926"><td class="memItemLeft" align="right" valign="top">unsigned char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vec__utils_8h.html#a0466f61ff76fc5d1182b1ddc3de08926">gen_orb_list</a> (long long det, <a class="el" href="structbyte__table.html">byte_table</a> *table, unsigned char *occ_orbs)</td></tr>
<tr class="memdesc:a0466f61ff76fc5d1182b1ddc3de08926"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate list of occupied orbitals from bit-string representation of a determinant.  <a href="vec__utils_8h.html#a0466f61ff76fc5d1182b1ddc3de08926">More...</a><br /></td></tr>
<tr class="separator:a0466f61ff76fc5d1182b1ddc3de08926"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac942174483e68e74349819e444d9c987"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vec__utils_8h.html#ac942174483e68e74349819e444d9c987">find_neighbors_1D</a> (long long det, unsigned int n_sites, <a class="el" href="structbyte__table.html">byte_table</a> *table, unsigned int n_elec, unsigned char neighbors[][n_elec+1])</td></tr>
<tr class="memdesc:ac942174483e68e74349819e444d9c987"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate lists of occupied orbitals in a determinant that are adjacent to an empty orbital if the orbitals represent sites on a 1-D lattice.  <a href="vec__utils_8h.html#ac942174483e68e74349819e444d9c987">More...</a><br /></td></tr>
<tr class="separator:ac942174483e68e74349819e444d9c987"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad36c4185ffd6cd33d3696922af748f2c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vec__utils_8h.html#ad36c4185ffd6cd33d3696922af748f2c">idx_to_proc</a> (<a class="el" href="structdist__vec.html">dist_vec</a> *vec, long long idx)</td></tr>
<tr class="memdesc:ad36c4185ffd6cd33d3696922af748f2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hash function mapping vector index to processor.  <a href="vec__utils_8h.html#ad36c4185ffd6cd33d3696922af748f2c">More...</a><br /></td></tr>
<tr class="separator:ad36c4185ffd6cd33d3696922af748f2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3033339dcbfb231508773a2eace2183"><td class="memItemLeft" align="right" valign="top">unsigned long long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vec__utils_8h.html#ae3033339dcbfb231508773a2eace2183">idx_to_hash</a> (<a class="el" href="structdist__vec.html">dist_vec</a> *vec, long long idx)</td></tr>
<tr class="memdesc:ae3033339dcbfb231508773a2eace2183"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hash function mapping vector index to local hash value.  <a href="vec__utils_8h.html#ae3033339dcbfb231508773a2eace2183">More...</a><br /></td></tr>
<tr class="separator:ae3033339dcbfb231508773a2eace2183"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a93f7536f7c6aa193b6d651c33bf1a2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vec__utils_8h.html#a5a93f7536f7c6aa193b6d651c33bf1a2">add_int</a> (<a class="el" href="structdist__vec.html">dist_vec</a> *vec, long long idx, int val, long long ini_flag)</td></tr>
<tr class="memdesc:a5a93f7536f7c6aa193b6d651c33bf1a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add an int to a vector.  <a href="vec__utils_8h.html#a5a93f7536f7c6aa193b6d651c33bf1a2">More...</a><br /></td></tr>
<tr class="separator:a5a93f7536f7c6aa193b6d651c33bf1a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadf9b869e27e3dc59f53ddf2490ec544"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vec__utils_8h.html#aadf9b869e27e3dc59f53ddf2490ec544">add_doub</a> (<a class="el" href="structdist__vec.html">dist_vec</a> *vec, long long idx, double val, long long ini_flag)</td></tr>
<tr class="memdesc:aadf9b869e27e3dc59f53ddf2490ec544"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a double to a vector.  <a href="vec__utils_8h.html#aadf9b869e27e3dc59f53ddf2490ec544">More...</a><br /></td></tr>
<tr class="separator:aadf9b869e27e3dc59f53ddf2490ec544"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f89a8b373646286bde9d2b57ba4e45a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vec__utils_8h.html#a4f89a8b373646286bde9d2b57ba4e45a">perform_add</a> (<a class="el" href="structdist__vec.html">dist_vec</a> *vec, long long ini_bit)</td></tr>
<tr class="memdesc:a4f89a8b373646286bde9d2b57ba4e45a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Incorporate elements from the buffer into the vector.  <a href="vec__utils_8h.html#a4f89a8b373646286bde9d2b57ba4e45a">More...</a><br /></td></tr>
<tr class="separator:a4f89a8b373646286bde9d2b57ba4e45a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88bff33fb27d9f909f86796a3dc1bcf5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vec__utils_8h.html#a88bff33fb27d9f909f86796a3dc1bcf5">del_at_pos</a> (<a class="el" href="structdist__vec.html">dist_vec</a> *vec, size_t pos)</td></tr>
<tr class="memdesc:a88bff33fb27d9f909f86796a3dc1bcf5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delete an element from the vector.  <a href="vec__utils_8h.html#a88bff33fb27d9f909f86796a3dc1bcf5">More...</a><br /></td></tr>
<tr class="separator:a88bff33fb27d9f909f86796a3dc1bcf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae02eb6edf034010ff730d76c29fffebf"><td class="memItemLeft" align="right" valign="top">int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vec__utils_8h.html#ae02eb6edf034010ff730d76c29fffebf">int_at_pos</a> (<a class="el" href="structdist__vec.html">dist_vec</a> *vec, size_t pos)</td></tr>
<tr class="memdesc:ae02eb6edf034010ff730d76c29fffebf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a pointer to an element in the vector.  <a href="vec__utils_8h.html#ae02eb6edf034010ff730d76c29fffebf">More...</a><br /></td></tr>
<tr class="separator:ae02eb6edf034010ff730d76c29fffebf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbb01ed27b39684243e01c24a3ea4e2a"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vec__utils_8h.html#acbb01ed27b39684243e01c24a3ea4e2a">doub_at_pos</a> (<a class="el" href="structdist__vec.html">dist_vec</a> *vec, size_t pos)</td></tr>
<tr class="memdesc:acbb01ed27b39684243e01c24a3ea4e2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a pointer to an element in the vector.  <a href="vec__utils_8h.html#acbb01ed27b39684243e01c24a3ea4e2a">More...</a><br /></td></tr>
<tr class="separator:acbb01ed27b39684243e01c24a3ea4e2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49168c16750e464f24f084f10a440dab"><td class="memItemLeft" align="right" valign="top">unsigned char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vec__utils_8h.html#a49168c16750e464f24f084f10a440dab">orbs_at_pos</a> (<a class="el" href="structdist__vec.html">dist_vec</a> *vec, size_t pos)</td></tr>
<tr class="memdesc:a49168c16750e464f24f084f10a440dab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a pointer to the list of occupied orbitals corresponding to an existing determinant index in the vector.  <a href="vec__utils_8h.html#a49168c16750e464f24f084f10a440dab">More...</a><br /></td></tr>
<tr class="separator:a49168c16750e464f24f084f10a440dab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ed7a60133db28be3373bca5e6fa8376"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vec__utils_8h.html#a0ed7a60133db28be3373bca5e6fa8376">local_norm</a> (<a class="el" href="structdist__vec.html">dist_vec</a> *vec)</td></tr>
<tr class="memdesc:a0ed7a60133db28be3373bca5e6fa8376"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the one-norm of a vector.  <a href="vec__utils_8h.html#a0ed7a60133db28be3373bca5e6fa8376">More...</a><br /></td></tr>
<tr class="separator:a0ed7a60133db28be3373bca5e6fa8376"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9662c50cef9426fc5d26d091bfd5d524"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vec__utils_8h.html#a9662c50cef9426fc5d26d091bfd5d524">save_vec</a> (<a class="el" href="structdist__vec.html">dist_vec</a> *vec, const char *path)</td></tr>
<tr class="separator:a9662c50cef9426fc5d26d091bfd5d524"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31c984dc329941fee5453e5881434304"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="vec__utils_8h.html#a31c984dc329941fee5453e5881434304">load_vec</a> (<a class="el" href="structdist__vec.html">dist_vec</a> *vec, const char *path)</td></tr>
<tr class="separator:a31c984dc329941fee5453e5881434304"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Utilities for storing and manipulating sparse vectors. </p>
<p>Supports sparse vectors distributed among multiple processes if USE_MPI is defined </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aadf9b869e27e3dc59f53ddf2490ec544"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadf9b869e27e3dc59f53ddf2490ec544">&#9670;&nbsp;</a></span>add_doub()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void add_doub </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdist__vec.html">dist_vec</a> *&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long&#160;</td>
          <td class="paramname"><em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long&#160;</td>
          <td class="paramname"><em>ini_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a double to a vector. </p>
<p>The element will be added to a buffer for later processing</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vec</td><td>The <a class="el" href="structdist__vec.html" title="Struct for storing a sparse vector.">dist_vec</a> struct to which the element will be added </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idx</td><td>The index of the element in the vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">val</td><td>The value of the added element </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ini_flag</td><td>A bit string indicating whether the added element came from an initiator element. None of the 1 bits should overlap with the orbitals encoded in the rest of the bit string </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5a93f7536f7c6aa193b6d651c33bf1a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a93f7536f7c6aa193b6d651c33bf1a2">&#9670;&nbsp;</a></span>add_int()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void add_int </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdist__vec.html">dist_vec</a> *&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long&#160;</td>
          <td class="paramname"><em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long&#160;</td>
          <td class="paramname"><em>ini_flag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add an int to a vector. </p>
<p>The element will be added to a buffer for later processing</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vec</td><td>The <a class="el" href="structdist__vec.html" title="Struct for storing a sparse vector.">dist_vec</a> struct to which the element will be added </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idx</td><td>The index of the element in the vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">val</td><td>The value of the added element </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ini_flag</td><td>A bit string indicating whether the added element came from an initiator element. None of the 1 bits should overlap with the orbitals encoded in the rest of the bit string </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a88bff33fb27d9f909f86796a3dc1bcf5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88bff33fb27d9f909f86796a3dc1bcf5">&#9670;&nbsp;</a></span>del_at_pos()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void del_at_pos </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdist__vec.html">dist_vec</a> *&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Delete an element from the vector. </p>
<p>Removes an element from the vector and modifies the hash table accordingly</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vec</td><td>The <a class="el" href="structdist__vec.html" title="Struct for storing a sparse vector.">dist_vec</a> struct from which to delete the element </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pos</td><td>The position of the element to be deleted in the element storage array of the <a class="el" href="structdist__vec.html" title="Struct for storing a sparse vector.">dist_vec</a> structure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="acbb01ed27b39684243e01c24a3ea4e2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbb01ed27b39684243e01c24a3ea4e2a">&#9670;&nbsp;</a></span>doub_at_pos()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double* doub_at_pos </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdist__vec.html">dist_vec</a> *&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a pointer to an element in the vector. </p>
<p>This function must be used in lieu of <code>vec-&gt;values</code>[<code>pos</code>] because the values are stored as a (void *) array</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vec</td><td>The <a class="el" href="structdist__vec.html" title="Struct for storing a sparse vector.">dist_vec</a> structure from which to read the element </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pos</td><td>The position of the desired element in the local storage </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac942174483e68e74349819e444d9c987"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac942174483e68e74349819e444d9c987">&#9670;&nbsp;</a></span>find_neighbors_1D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void find_neighbors_1D </td>
          <td>(</td>
          <td class="paramtype">long long&#160;</td>
          <td class="paramname"><em>det</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n_sites</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structbyte__table.html">byte_table</a> *&#160;</td>
          <td class="paramname"><em>table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n_elec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>neighbors</em>[][n_elec+1]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate lists of occupied orbitals in a determinant that are adjacent to an empty orbital if the orbitals represent sites on a 1-D lattice. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">det</td><td>bit string representation of the determinant </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_sites</td><td>number of sites in the lattice </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">table</td><td>byte table struct generated by <a class="el" href="math__utils_8c.html#ad24adf232f439607b3c910ce5c698553" title="Generate and initialize a byte_table struct.">gen_byte_table()</a> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_elec</td><td>number of electrons in the system </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">neighbors</td><td>2-D array whose 0th row indicates orbitals with an empty adjacent orbital to the left, and 1st row is for empty orbitals to the right. Elements in the 0th column indicate number of elements in each row. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0466f61ff76fc5d1182b1ddc3de08926"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0466f61ff76fc5d1182b1ddc3de08926">&#9670;&nbsp;</a></span>gen_orb_list()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char gen_orb_list </td>
          <td>(</td>
          <td class="paramtype">long long&#160;</td>
          <td class="paramname"><em>det</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structbyte__table.html">byte_table</a> *&#160;</td>
          <td class="paramname"><em>table</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>occ_orbs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate list of occupied orbitals from bit-string representation of a determinant. </p>
<p>This implementation uses the procedure in Sec. 3.1 of Booth et al. (2014) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">det</td><td>bit string to be parsed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">table</td><td>byte table structure generated by <a class="el" href="math__utils_8c.html#ad24adf232f439607b3c910ce5c698553" title="Generate and initialize a byte_table struct.">gen_byte_table()</a> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">occ_orbs</td><td>Occupied orbitals in the determinant </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>number of 1 bits in the bit string </dd></dl>

</div>
</div>
<a id="ae3033339dcbfb231508773a2eace2183"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3033339dcbfb231508773a2eace2183">&#9670;&nbsp;</a></span>idx_to_hash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long long idx_to_hash </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdist__vec.html">dist_vec</a> *&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long&#160;</td>
          <td class="paramname"><em>idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Hash function mapping vector index to local hash value. </p>
<p>The local hash value is used to find the index on a particular processor</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vec</td><td>Pointer to distributed sparse vector struct </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idx</td><td><a class="el" href="struct_vector.html">Vector</a> index </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>hash value </dd></dl>

</div>
</div>
<a id="ad36c4185ffd6cd33d3696922af748f2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad36c4185ffd6cd33d3696922af748f2c">&#9670;&nbsp;</a></span>idx_to_proc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int idx_to_proc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdist__vec.html">dist_vec</a> *&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long&#160;</td>
          <td class="paramname"><em>idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Hash function mapping vector index to processor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vec</td><td>Pointer to distributed sparse vector struct </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idx</td><td><a class="el" href="struct_vector.html">Vector</a> index </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>processor index from hash value </dd></dl>

</div>
</div>
<a id="aed580ea34c25917782168ed22fef2590"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed580ea34c25917782168ed22fef2590">&#9670;&nbsp;</a></span>init_adder()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structadder.html">adder</a>* init_adder </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dtype&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Setup an adder struct. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>Maximum number of elements per MPI process to use in buffers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td>Type of elements to be added </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to newly created adder struct </dd></dl>

</div>
</div>
<a id="a7b532066b2b1bc46153e98858b0dd938"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b532066b2b1bc46153e98858b0dd938">&#9670;&nbsp;</a></span>init_vec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structdist__vec.html">dist_vec</a>* init_vec </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>add_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmt__struct.html">mt_struct</a> *&#160;</td>
          <td class="paramname"><em>rn_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n_orb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n_elec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dtype&#160;</td>
          <td class="paramname"><em>vec_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_sites</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set up a <a class="el" href="structdist__vec.html" title="Struct for storing a sparse vector.">dist_vec</a> struct. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>Maximum number of elements to be stored </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">add_size</td><td>Maximum number of elements per processor to use in adder buffers </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rn_ptr</td><td>Pointer to an <a class="el" href="structmt__struct.html">mt_struct</a> object for RN generation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_orb</td><td>Number of spatial orbitals in the basis (half the length of the vector of random numbers for the hash function for processors) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_elec</td><td>Number of electrons represented in each vector index </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vec_type</td><td>Data type of vector elements </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_sites</td><td>If the orbitals in vector indices represent lattice sites, the number of sites along one dimension. 0 otherwise. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to the newly allocated struct </dd></dl>

</div>
</div>
<a id="ae02eb6edf034010ff730d76c29fffebf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae02eb6edf034010ff730d76c29fffebf">&#9670;&nbsp;</a></span>int_at_pos()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int* int_at_pos </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdist__vec.html">dist_vec</a> *&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a pointer to an element in the vector. </p>
<p>This function must be used in lieu of <code>vec-&gt;values</code>[<code>pos</code>] because the values are stored as a (void *) array</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vec</td><td>The <a class="el" href="structdist__vec.html" title="Struct for storing a sparse vector.">dist_vec</a> structure from which to read the element </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pos</td><td>The position of the desired element in the local storage </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a31c984dc329941fee5453e5881434304"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31c984dc329941fee5453e5881434304">&#9670;&nbsp;</a></span>load_vec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void load_vec </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdist__vec.html">dist_vec</a> *&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Load a vector from disk in binary format</p>
<p>The vector indices from each MPI process are read from the file [path]dets[MPI rank].dat, and the values from [path]vals[MPI rank].dat</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">vec</td><td>Pointer to an allocated and initialized <a class="el" href="structdist__vec.html" title="Struct for storing a sparse vector.">dist_vec</a> struct </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">path</td><td>Location where the files are to be stored </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0ed7a60133db28be3373bca5e6fa8376"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ed7a60133db28be3373bca5e6fa8376">&#9670;&nbsp;</a></span>local_norm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double local_norm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdist__vec.html">dist_vec</a> *&#160;</td>
          <td class="paramname"><em>vec</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the one-norm of a vector. </p>
<p>This function sums over the elements on all MPI processes</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vec</td><td>The vector whose one-norm is to be calculated </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The one-norm of the vector </dd></dl>

</div>
</div>
<a id="a49168c16750e464f24f084f10a440dab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49168c16750e464f24f084f10a440dab">&#9670;&nbsp;</a></span>orbs_at_pos()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char* orbs_at_pos </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdist__vec.html">dist_vec</a> *&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get a pointer to the list of occupied orbitals corresponding to an existing determinant index in the vector. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vec</td><td>The <a class="el" href="structdist__vec.html" title="Struct for storing a sparse vector.">dist_vec</a> structure to reference </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pos</td><td>The position of the index in the local storage </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4f89a8b373646286bde9d2b57ba4e45a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f89a8b373646286bde9d2b57ba4e45a">&#9670;&nbsp;</a></span>perform_add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void perform_add </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdist__vec.html">dist_vec</a> *&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long&#160;</td>
          <td class="paramname"><em>ini_bit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Incorporate elements from the buffer into the vector. </p>
<p>Sign-coherent elements are added regardless of their corresponding initiator flags. Otherwise, only elements with nonzero initiator flags are added</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vec</td><td>The <a class="el" href="structdist__vec.html" title="Struct for storing a sparse vector.">dist_vec</a> struct on which to perform addition </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ini_bit</td><td>A bit mask defining where to look for initiator flags in added elements </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9662c50cef9426fc5d26d091bfd5d524"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9662c50cef9426fc5d26d091bfd5d524">&#9670;&nbsp;</a></span>save_vec()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void save_vec </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdist__vec.html">dist_vec</a> *&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Save a vector to disk in binary format</p>
<p>The vector indices from each MPI process are stored in the file [path]dets[MPI rank].dat, and the values at [path]vals[MPI rank].dat</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vec</td><td>Pointer to the vector to save </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">path</td><td>Location where the files are to be stored </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aad8dfe7b8eaeacd51213bc706e6d22fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad8dfe7b8eaeacd51213bc706e6d22fd">&#9670;&nbsp;</a></span>vec_dot()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double vec_dot </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdist__vec.html">dist_vec</a> *&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long *&#160;</td>
          <td class="paramname"><em>idx2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>vals2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>num2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long long *&#160;</td>
          <td class="paramname"><em>hashes2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate dot product. </p>
<p>Calculates dot product of a vector distributed across potentially many MPI processes with a local sparse vector (such that the local results could be added)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">vec</td><td>Struct containing the distributed vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idx2</td><td>Indices of elements in the local vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">vals2</td><td>Values of elements in the local vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">num2</td><td>Number of elements in the local vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hashes2</td><td>hash values of the indices of the local vector from the hash table of vec </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the value of the dot product </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
